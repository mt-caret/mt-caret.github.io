var data = {lines:[
{"lineNum":"    1","line":"use crate::utils::*;"},
{"lineNum":"    2","line":"use chrono::naive::{NaiveDate, NaiveDateTime};"},
{"lineNum":"    3","line":"use ocaml_interop::{"},
{"lineNum":"    4","line":"    BoxRoot, DynBox, OCaml, OCamlBytes, OCamlFloat, OCamlInt, OCamlList, OCamlRef, OCamlRuntime,"},
{"lineNum":"    5","line":"    ToOCaml,"},
{"lineNum":"    6","line":"};"},
{"lineNum":"    7","line":"use polars::prelude::prelude::*;"},
{"lineNum":"    8","line":"use polars::prelude::*;"},
{"lineNum":"    9","line":"use polars_ocaml_macros::ocaml_interop_export;"},
{"lineNum":"   10","line":""},
{"lineNum":"   11","line":"// The rough idea of functions which take GADTDataType is that the argument or"},
{"lineNum":"   12","line":"// the return type depends on the value of the GADTDataType, so we hide the"},
{"lineNum":"   13","line":"// actual type of the argument or return value behind a DummyBoxRoot and"},
{"lineNum":"   14","line":"// interpret it with or produce the value of the correct type later."},
{"lineNum":"   15","line":"//"},
{"lineNum":"   16","line":"// In the case of series_new takes a vec of DummyBoxRoots, and we recurse when"},
{"lineNum":"   17","line":"// data_type turns out to be a GADTDataType::List(inner_data_type)."},
{"lineNum":"   18","line":"pub fn series_new(","class":"lineCov","hits":"1","order":"152",},
{"lineNum":"   19","line":"    cr: &mut &mut OCamlRuntime,","class":"lineCov","hits":"1","order":"156",},
{"lineNum":"   20","line":"    data_type: &GADTDataType,"},
{"lineNum":"   21","line":"    name: &str,"},
{"lineNum":"   22","line":"    // TODO: can we just pass a DummyBoxRoot here instead of a Vec, and save a copy?"},
{"lineNum":"   23","line":"    values: Vec<DummyBoxRoot>,"},
{"lineNum":"   24","line":"    are_values_options: bool,"},
{"lineNum":"   25","line":") -> Result<Series, String> {"},
{"lineNum":"   26","line":"    macro_rules! create_series {"},
{"lineNum":"   27","line":"        ($ocaml_type:ty, $rust_type:ty) => {{"},
{"lineNum":"   28","line":"            if are_values_options {"},
{"lineNum":"   29","line":"                let values: Vec<Option<$rust_type>> = values"},
{"lineNum":"   30","line":"                    .into_iter()"},
{"lineNum":"   31","line":"                    .map(|v| v.interpret::<Option<$ocaml_type>>(cr).to_rust())","class":"lineCov","hits":"1","order":"659",},
{"lineNum":"   32","line":"                    .collect();"},
{"lineNum":"   33","line":"                Ok(Series::new(&name, values))"},
{"lineNum":"   34","line":"            } else {"},
{"lineNum":"   35","line":"                let values: Vec<$rust_type> = values"},
{"lineNum":"   36","line":"                    .into_iter()"},
{"lineNum":"   37","line":"                    .map(|v| v.interpret::<$ocaml_type>(cr).to_rust())","class":"lineCov","hits":"1","order":"155",},
{"lineNum":"   38","line":"                    .collect();"},
{"lineNum":"   39","line":"                Ok(Series::new(&name, values))"},
{"lineNum":"   40","line":"            }"},
{"lineNum":"   41","line":"        }};"},
{"lineNum":"   42","line":"    }"},
{"lineNum":"   43","line":""},
{"lineNum":"   44","line":"    macro_rules! create_int_series {"},
{"lineNum":"   45","line":"        ($rust_type:ty) => {{"},
{"lineNum":"   46","line":"            if are_values_options {"},
{"lineNum":"   47","line":"                let values = values"},
{"lineNum":"   48","line":"                    .into_iter()"},
{"lineNum":"   49","line":"                    .map("},
{"lineNum":"   50","line":"                        |v| match v.interpret::<Option<OCamlInt>>(cr).to_rust::<Option<i64>>() {","class":"lineCov","hits":"1","order":"500",},
{"lineNum":"   51","line":"                            None => Ok(None),","class":"lineCov","hits":"1","order":"503",},
{"lineNum":"   52","line":"                            Some(int) => int.try_into().map(Some),","class":"lineCov","hits":"1","order":"501",},
{"lineNum":"   53","line":"                        },","class":"lineCov","hits":"1","order":"502",},
{"lineNum":"   54","line":"                    )"},
{"lineNum":"   55","line":"                    .collect::<Result<Vec<Option<$rust_type>>, _>>()"},
{"lineNum":"   56","line":"                    .map_err(|err| err.to_string())?;","class":"lineNoCov","hits":"0",},
{"lineNum":"   57","line":"                Ok(Series::new(&name, values))"},
{"lineNum":"   58","line":"            } else {"},
{"lineNum":"   59","line":"                let values = values"},
{"lineNum":"   60","line":"                    .into_iter()"},
{"lineNum":"   61","line":"                    .map(|v| v.interpret::<OCamlInt>(cr).to_rust::<i64>().try_into())","class":"lineCov","hits":"1","order":"165",},
{"lineNum":"   62","line":"                    .collect::<Result<Vec<$rust_type>, _>>()"},
{"lineNum":"   63","line":"                    .map_err(|err| err.to_string())?;","class":"lineNoCov","hits":"0",},
{"lineNum":"   64","line":"                Ok(Series::new(&name, values))"},
{"lineNum":"   65","line":"            }"},
{"lineNum":"   66","line":"        }};"},
{"lineNum":"   67","line":"    }"},
{"lineNum":"   68","line":""},
{"lineNum":"   69","line":"    match data_type {","class":"lineCov","hits":"1","order":"153",},
{"lineNum":"   70","line":"        GADTDataType::Boolean => create_series!(bool, bool),","class":"lineCov","hits":"1","order":"200",},
{"lineNum":"   71","line":"        GADTDataType::UInt8 => create_int_series!(u8),","class":"lineCov","hits":"1","order":"576",},
{"lineNum":"   72","line":"        GADTDataType::UInt16 => create_int_series!(u16),","class":"lineCov","hits":"1","order":"605",},
{"lineNum":"   73","line":"        GADTDataType::UInt32 => create_int_series!(u32),","class":"lineCov","hits":"1","order":"614",},
{"lineNum":"   74","line":"        GADTDataType::UInt64 => create_int_series!(u64),","class":"lineCov","hits":"1","order":"608",},
{"lineNum":"   75","line":"        GADTDataType::Int8 => create_int_series!(i8),","class":"lineCov","hits":"1","order":"544",},
{"lineNum":"   76","line":"        GADTDataType::Int16 => create_int_series!(i16),","class":"lineCov","hits":"1","order":"601",},
{"lineNum":"   77","line":"        GADTDataType::Int32 => create_int_series!(i32),","class":"lineCov","hits":"1","order":"599",},
{"lineNum":"   78","line":"        GADTDataType::Int64 => create_int_series!(i64),","class":"lineCov","hits":"1","order":"164",},
{"lineNum":"   79","line":"        GADTDataType::Float32 => {"},
{"lineNum":"   80","line":"            if are_values_options {","class":"lineCov","hits":"1","order":"582",},
{"lineNum":"   81","line":"                let values: Vec<Option<f32>> = values","class":"lineCov","hits":"1","order":"651",},
{"lineNum":"   82","line":"                    .into_iter()"},
{"lineNum":"   83","line":"                    .map(|v| {","class":"lineCov","hits":"1","order":"652",},
{"lineNum":"   84","line":"                        v.interpret::<Option<OCamlFloat>>(cr)","class":"lineCov","hits":"1","order":"653",},
{"lineNum":"   85","line":"                            .to_rust::<Option<f64>>()"},
{"lineNum":"   86","line":"                            .map(|f64| f64 as f32)","class":"lineCov","hits":"1","order":"660",},
{"lineNum":"   87","line":"                    })","class":"lineCov","hits":"1","order":"654",},
{"lineNum":"   88","line":"                    .collect();"},
{"lineNum":"   89","line":"                Ok(Series::new(&name, values))","class":"lineCov","hits":"1","order":"655",},
{"lineNum":"   90","line":"            } else {"},
{"lineNum":"   91","line":"                let values: Vec<f32> = values","class":"lineCov","hits":"1","order":"583",},
{"lineNum":"   92","line":"                    .into_iter()"},
{"lineNum":"   93","line":"                    .map(|v| v.interpret::<OCamlFloat>(cr).to_rust::<f64>() as f32)","class":"lineCov","hits":"1","order":"584",},
{"lineNum":"   94","line":"                    .collect();"},
{"lineNum":"   95","line":"                Ok(Series::new(&name, values))","class":"lineCov","hits":"1","order":"585",},
{"lineNum":"   96","line":"            }"},
{"lineNum":"   97","line":"        }"},
{"lineNum":"   98","line":"        GADTDataType::Float64 => create_series!(OCamlFloat, f64),","class":"lineCov","hits":"1","order":"154",},
{"lineNum":"   99","line":"        GADTDataType::Utf8 => create_series!(String, String),","class":"lineCov","hits":"1","order":"204",},
{"lineNum":"  100","line":"        GADTDataType::Binary => create_series!(OCamlBytes, Vec<u8>),","class":"lineCov","hits":"1","order":"519",},
{"lineNum":"  101","line":"        GADTDataType::List(data_type) => {","class":"lineCov","hits":"1","order":"192",},
{"lineNum":"  102","line":"            // Series creation doesn\'t work for empty lists and use of"},
{"lineNum":"  103","line":"            // `Series::new_empty` is suggested instead."},
{"lineNum":"  104","line":"            // https://github.com/pola-rs/polars/pull/10558#issuecomment-1684923274"},
{"lineNum":"  105","line":"            if values.is_empty() {","class":"lineCov","hits":"1","order":"193",},
{"lineNum":"  106","line":"                let data_type = DataType::List(Box::new(data_type.to_data_type()));","class":"lineCov","hits":"1","order":"569",},
{"lineNum":"  107","line":"                return Ok(Series::new_empty(&name, &data_type));","class":"lineCov","hits":"1","order":"574",},
{"lineNum":"  108","line":"            }","class":"lineCov","hits":"1","order":"575",},
{"lineNum":"  109","line":""},
{"lineNum":"  110","line":"            if are_values_options {","class":"lineCov","hits":"1","order":"194",},
{"lineNum":"  111","line":"                let values: Vec<Option<Series>> = values","class":"lineCov","hits":"1","order":"643",},
{"lineNum":"  112","line":"                    .into_iter()"},
{"lineNum":"  113","line":"                    .map(|v| {","class":"lineCov","hits":"1","order":"644",},
{"lineNum":"  114","line":"                        match v.interpret::<Option<OCamlList<DummyBoxRoot>>>(cr).to_rust() {","class":"lineCov","hits":"1","order":"645",},
{"lineNum":"  115","line":"                            None => Ok(None),","class":"lineCov","hits":"1","order":"656",},
{"lineNum":"  116","line":"                            Some(list) => series_new(","class":"lineCov","hits":"1","order":"646",},
{"lineNum":"  117","line":"                                cr, data_type, name, list,","class":"lineCov","hits":"1","order":"647",},
{"lineNum":"  118","line":"                                // The OCaml GADT\'s type assumes all values are non-null for simplicity,"},
{"lineNum":"  119","line":"                                // but we expose a top-level function that allows the outermost layer"},
{"lineNum":"  120","line":"                                // to be optional. So, all recursive layers are non-optional so"},
{"lineNum":"  121","line":"                                // are_values_options=false."},
{"lineNum":"  122","line":"                                false,"},
{"lineNum":"  123","line":"                            )"},
{"lineNum":"  124","line":"                            .map(Some),"},
{"lineNum":"  125","line":"                        }"},
{"lineNum":"  126","line":"                    })","class":"lineCov","hits":"1","order":"648",},
{"lineNum":"  127","line":"                    .collect::<Result<Vec<Option<Series>>, _>>()?;","class":"lineNoCov","hits":"0",},
{"lineNum":"  128","line":"                Ok(Series::new(&name, values))","class":"lineCov","hits":"1","order":"649",},
{"lineNum":"  129","line":"            } else {","class":"lineCov","hits":"1","order":"650",},
{"lineNum":"  130","line":"                let values: Vec<Series> = values","class":"lineCov","hits":"1","order":"195",},
{"lineNum":"  131","line":"                    .into_iter()"},
{"lineNum":"  132","line":"                    .map(|v| {","class":"lineCov","hits":"1","order":"196",},
{"lineNum":"  133","line":"                        let list = v.interpret::<OCamlList<DummyBoxRoot>>(cr).to_rust();","class":"lineCov","hits":"1","order":"197",},
{"lineNum":"  134","line":"                        series_new(","class":"lineCov","hits":"1","order":"199",},
{"lineNum":"  135","line":"                            cr, data_type, name, list, // See call above to series_new","class":"lineCov","hits":"1","order":"198",},
{"lineNum":"  136","line":"                            false,"},
{"lineNum":"  137","line":"                        )"},
{"lineNum":"  138","line":"                    })","class":"lineCov","hits":"1","order":"201",},
{"lineNum":"  139","line":"                    .collect::<Result<Vec<Series>, _>>()?;","class":"lineNoCov","hits":"0",},
{"lineNum":"  140","line":""},
{"lineNum":"  141","line":"                Ok(Series::new(&name, values))","class":"lineCov","hits":"1","order":"202",},
{"lineNum":"  142","line":"            }","class":"lineCov","hits":"1","order":"203",},
{"lineNum":"  143","line":"        }"},
{"lineNum":"  144","line":"    }"},
{"lineNum":"  145","line":"}","class":"lineCov","hits":"1","order":"161",},
{"lineNum":"  146","line":""},
{"lineNum":"  147","line":"#[ocaml_interop_export(raise_on_err)]","class":"lineCov","hits":"1","order":"140",},
{"lineNum":"  148","line":"fn rust_series_new("},
{"lineNum":"  149","line":"    cr: &mut &mut OCamlRuntime,","class":"lineCov","hits":"1","order":"141",},
{"lineNum":"  150","line":"    data_type: OCamlRef<GADTDataType>,","class":"lineCov","hits":"1","order":"142",},
{"lineNum":"  151","line":"    name: OCamlRef<String>,","class":"lineCov","hits":"1","order":"143",},
{"lineNum":"  152","line":"    values: OCamlRef<OCamlList<DummyBoxRoot>>,","class":"lineCov","hits":"1","order":"144",},
{"lineNum":"  153","line":") -> OCaml<DynBox<Series>> {"},
{"lineNum":"  154","line":"    let name: String = name.to_rust(cr);","class":"lineCov","hits":"1","order":"145",},
{"lineNum":"  155","line":"    let data_type: GADTDataType = data_type.to_rust(cr);","class":"lineCov","hits":"1","order":"146",},
{"lineNum":"  156","line":"    let values: Vec<DummyBoxRoot> = values.to_rust(cr);","class":"lineCov","hits":"1","order":"147",},
{"lineNum":"  157","line":""},
{"lineNum":"  158","line":"    let series = series_new(cr, &data_type, &name, values, false)?;","class":"lineCov","hits":"1","order":"151",},
{"lineNum":"  159","line":""},
{"lineNum":"  160","line":"    OCaml::box_value(cr, series)","class":"lineCov","hits":"1","order":"162",},
{"lineNum":"  161","line":"}","class":"lineCov","hits":"1","order":"163",},
{"lineNum":"  162","line":""},
{"lineNum":"  163","line":"#[ocaml_interop_export(raise_on_err)]","class":"lineCov","hits":"1","order":"491",},
{"lineNum":"  164","line":"fn rust_series_new_option("},
{"lineNum":"  165","line":"    cr: &mut &mut OCamlRuntime,","class":"lineCov","hits":"1","order":"492",},
{"lineNum":"  166","line":"    data_type: OCamlRef<GADTDataType>,","class":"lineCov","hits":"1","order":"493",},
{"lineNum":"  167","line":"    name: OCamlRef<String>,","class":"lineCov","hits":"1","order":"494",},
{"lineNum":"  168","line":"    values: OCamlRef<OCamlList<DummyBoxRoot>>,","class":"lineCov","hits":"1","order":"495",},
{"lineNum":"  169","line":") -> OCaml<DynBox<Series>> {"},
{"lineNum":"  170","line":"    let name: String = name.to_rust(cr);","class":"lineCov","hits":"1","order":"496",},
{"lineNum":"  171","line":"    let data_type: GADTDataType = data_type.to_rust(cr);","class":"lineCov","hits":"1","order":"497",},
{"lineNum":"  172","line":"    let values: Vec<DummyBoxRoot> = values.to_rust(cr);","class":"lineCov","hits":"1","order":"498",},
{"lineNum":"  173","line":""},
{"lineNum":"  174","line":"    let series = series_new(cr, &data_type, &name, values, true)?;","class":"lineCov","hits":"1","order":"499",},
{"lineNum":"  175","line":""},
{"lineNum":"  176","line":"    OCaml::box_value(cr, series)","class":"lineCov","hits":"1","order":"504",},
{"lineNum":"  177","line":"}","class":"lineCov","hits":"1","order":"505",},
{"lineNum":"  178","line":""},
{"lineNum":"  179","line":"#[ocaml_interop_export(raise_on_err)]","class":"lineCov","hits":"1","order":"526",},
{"lineNum":"  180","line":"fn rust_series_new_array("},
{"lineNum":"  181","line":"    cr: &mut &mut OCamlRuntime,","class":"lineCov","hits":"1","order":"527",},
{"lineNum":"  182","line":"    data_type: OCamlRef<GADTDataType>,","class":"lineCov","hits":"1","order":"528",},
{"lineNum":"  183","line":"    name: OCamlRef<String>,","class":"lineCov","hits":"1","order":"529",},
{"lineNum":"  184","line":"    values: OCamlRef<OCamlUniformArray<DummyBoxRoot>>,","class":"lineCov","hits":"1","order":"530",},
{"lineNum":"  185","line":") -> OCaml<DynBox<Series>> {"},
{"lineNum":"  186","line":"    let name: String = name.to_rust(cr);","class":"lineCov","hits":"1","order":"531",},
{"lineNum":"  187","line":"    let data_type: GADTDataType = data_type.to_rust(cr);","class":"lineCov","hits":"1","order":"532",},
{"lineNum":"  188","line":"    let values: Vec<DummyBoxRoot> = values.to_rust(cr);","class":"lineCov","hits":"1","order":"533",},
{"lineNum":"  189","line":""},
{"lineNum":"  190","line":"    let series = series_new(cr, &data_type, &name, values, false)?;","class":"lineCov","hits":"1","order":"541",},
{"lineNum":"  191","line":""},
{"lineNum":"  192","line":"    OCaml::box_value(cr, series)","class":"lineCov","hits":"1","order":"542",},
{"lineNum":"  193","line":"}","class":"lineCov","hits":"1","order":"543",},
{"lineNum":"  194","line":""},
{"lineNum":"  195","line":"#[ocaml_interop_export(raise_on_err)]","class":"lineCov","hits":"1","order":"632",},
{"lineNum":"  196","line":"fn rust_series_new_option_array("},
{"lineNum":"  197","line":"    cr: &mut &mut OCamlRuntime,","class":"lineCov","hits":"1","order":"633",},
{"lineNum":"  198","line":"    data_type: OCamlRef<GADTDataType>,","class":"lineCov","hits":"1","order":"634",},
{"lineNum":"  199","line":"    name: OCamlRef<String>,","class":"lineCov","hits":"1","order":"635",},
{"lineNum":"  200","line":"    values: OCamlRef<OCamlUniformArray<DummyBoxRoot>>,","class":"lineCov","hits":"1","order":"636",},
{"lineNum":"  201","line":") -> OCaml<DynBox<Series>> {"},
{"lineNum":"  202","line":"    let name: String = name.to_rust(cr);","class":"lineCov","hits":"1","order":"637",},
{"lineNum":"  203","line":"    let data_type: GADTDataType = data_type.to_rust(cr);","class":"lineCov","hits":"1","order":"638",},
{"lineNum":"  204","line":"    let values: Vec<DummyBoxRoot> = values.to_rust(cr);","class":"lineCov","hits":"1","order":"639",},
{"lineNum":"  205","line":""},
{"lineNum":"  206","line":"    let series = series_new(cr, &data_type, &name, values, true)?;","class":"lineCov","hits":"1","order":"640",},
{"lineNum":"  207","line":""},
{"lineNum":"  208","line":"    OCaml::box_value(cr, series)","class":"lineCov","hits":"1","order":"641",},
{"lineNum":"  209","line":"}","class":"lineCov","hits":"1","order":"642",},
{"lineNum":"  210","line":""},
{"lineNum":"  211","line":"#[ocaml_interop_export]","class":"lineCov","hits":"1","order":"681",},
{"lineNum":"  212","line":"fn rust_series_new_datetime("},
{"lineNum":"  213","line":"    cr: &mut &mut OCamlRuntime,","class":"lineCov","hits":"1","order":"682",},
{"lineNum":"  214","line":"    name: OCamlRef<String>,","class":"lineCov","hits":"1","order":"683",},
{"lineNum":"  215","line":"    values: OCamlRef<OCamlList<DynBox<NaiveDateTime>>>,","class":"lineCov","hits":"1","order":"684",},
{"lineNum":"  216","line":") -> OCaml<DynBox<Series>> {"},
{"lineNum":"  217","line":"    let name: String = name.to_rust(cr);","class":"lineCov","hits":"1","order":"685",},
{"lineNum":"  218","line":"    let values = unwrap_abstract_vec(values.to_rust(cr));","class":"lineCov","hits":"1","order":"686",},
{"lineNum":"  219","line":"    OCaml::box_value(cr, Series::new(&name, values))","class":"lineCov","hits":"1","order":"687",},
{"lineNum":"  220","line":"}","class":"lineCov","hits":"1","order":"688",},
{"lineNum":"  221","line":""},
{"lineNum":"  222","line":"#[ocaml_interop_export]","class":"lineCov","hits":"1","order":"480",},
{"lineNum":"  223","line":"fn rust_series_new_datetime_option("},
{"lineNum":"  224","line":"    cr: &mut &mut OCamlRuntime,","class":"lineCov","hits":"1","order":"481",},
{"lineNum":"  225","line":"    name: OCamlRef<String>,","class":"lineCov","hits":"1","order":"482",},
{"lineNum":"  226","line":"    values: OCamlRef<OCamlList<Option<DynBox<NaiveDateTime>>>>,","class":"lineCov","hits":"1","order":"483",},
{"lineNum":"  227","line":") -> OCaml<DynBox<Series>> {"},
{"lineNum":"  228","line":"    let name: String = name.to_rust(cr);","class":"lineCov","hits":"1","order":"484",},
{"lineNum":"  229","line":"    let values: Vec<Option<NaiveDateTime>> = values","class":"lineCov","hits":"1","order":"486",},
{"lineNum":"  230","line":"        .to_rust::<Vec<Option<_>>>(cr)","class":"lineCov","hits":"1","order":"485",},
{"lineNum":"  231","line":"        .into_iter()"},
{"lineNum":"  232","line":"        .map(|o| o.map(|Abstract(v)| v))","class":"lineCov","hits":"1","order":"487",},
{"lineNum":"  233","line":"        .collect();","class":"lineCov","hits":"1","order":"488",},
{"lineNum":"  234","line":""},
{"lineNum":"  235","line":"    OCaml::box_value(cr, Series::new(&name, values))","class":"lineCov","hits":"1","order":"489",},
{"lineNum":"  236","line":"}","class":"lineCov","hits":"1","order":"490",},
{"lineNum":"  237","line":""},
{"lineNum":"  238","line":"#[ocaml_interop_export]","class":"lineCov","hits":"1","order":"1059",},
{"lineNum":"  239","line":"fn rust_series_new_date("},
{"lineNum":"  240","line":"    cr: &mut &mut OCamlRuntime,","class":"lineCov","hits":"1","order":"1064",},
{"lineNum":"  241","line":"    name: OCamlRef<String>,","class":"lineCov","hits":"1","order":"1065",},
{"lineNum":"  242","line":"    values: OCamlRef<OCamlList<DynBox<NaiveDate>>>,","class":"lineCov","hits":"1","order":"1066",},
{"lineNum":"  243","line":") -> OCaml<DynBox<Series>> {"},
{"lineNum":"  244","line":"    let name: String = name.to_rust(cr);","class":"lineCov","hits":"1","order":"1067",},
{"lineNum":"  245","line":"    let values = unwrap_abstract_vec(values.to_rust(cr));","class":"lineCov","hits":"1","order":"1068",},
{"lineNum":"  246","line":"    OCaml::box_value(cr, Series::new(&name, values))","class":"lineCov","hits":"1","order":"1069",},
{"lineNum":"  247","line":"}","class":"lineCov","hits":"1","order":"1057",},
{"lineNum":"  248","line":""},
{"lineNum":"  249","line":"#[ocaml_interop_export]","class":"lineCov","hits":"1","order":"455",},
{"lineNum":"  250","line":"fn rust_series_new_date_option("},
{"lineNum":"  251","line":"    cr: &mut &mut OCamlRuntime,","class":"lineCov","hits":"1","order":"456",},
{"lineNum":"  252","line":"    name: OCamlRef<String>,","class":"lineCov","hits":"1","order":"457",},
{"lineNum":"  253","line":"    values: OCamlRef<OCamlList<Option<DynBox<NaiveDate>>>>,","class":"lineCov","hits":"1","order":"458",},
{"lineNum":"  254","line":") -> OCaml<DynBox<Series>> {"},
{"lineNum":"  255","line":"    let name: String = name.to_rust(cr);","class":"lineCov","hits":"1","order":"459",},
{"lineNum":"  256","line":"    let values: Vec<Option<NaiveDate>> = values","class":"lineCov","hits":"1","order":"461",},
{"lineNum":"  257","line":"        .to_rust::<Vec<Option<_>>>(cr)","class":"lineCov","hits":"1","order":"460",},
{"lineNum":"  258","line":"        .into_iter()"},
{"lineNum":"  259","line":"        .map(|o| o.map(|Abstract(v)| v))","class":"lineCov","hits":"1","order":"462",},
{"lineNum":"  260","line":"        .collect();","class":"lineCov","hits":"1","order":"463",},
{"lineNum":"  261","line":""},
{"lineNum":"  262","line":"    OCaml::box_value(cr, Series::new(&name, values))","class":"lineCov","hits":"1","order":"464",},
{"lineNum":"  263","line":"}","class":"lineCov","hits":"1","order":"465",},
{"lineNum":"  264","line":""},
{"lineNum":"  265","line":"#[ocaml_interop_export]","class":"lineCov","hits":"1","order":"1060",},
{"lineNum":"  266","line":"fn rust_series_date_range("},
{"lineNum":"  267","line":"    cr: &mut &mut OCamlRuntime,","class":"lineCov","hits":"1","order":"1070",},
{"lineNum":"  268","line":"    name: OCamlRef<String>,","class":"lineCov","hits":"1","order":"1071",},
{"lineNum":"  269","line":"    start: OCamlRef<DynBox<NaiveDateTime>>,","class":"lineCov","hits":"1","order":"1049",},
{"lineNum":"  270","line":"    stop: OCamlRef<DynBox<NaiveDateTime>>,","class":"lineCov","hits":"1","order":"1048",},
{"lineNum":"  271","line":"    every: OCamlRef<Option<String>>,","class":"lineCov","hits":"1","order":"1047",},
{"lineNum":"  272","line":"    cast_to_date: OCamlRef<bool>,","class":"lineCov","hits":"1","order":"1046",},
{"lineNum":"  273","line":") -> OCaml<Result<DynBox<Series>, String>> {"},
{"lineNum":"  274","line":"    let name: String = name.to_rust(cr);","class":"lineCov","hits":"1","order":"1045",},
{"lineNum":"  275","line":""},
{"lineNum":"  276","line":"    let Abstract(start) = start.to_rust(cr);","class":"lineCov","hits":"1","order":"1044",},
{"lineNum":"  277","line":"    let Abstract(stop) = stop.to_rust(cr);","class":"lineCov","hits":"1","order":"1042",},
{"lineNum":"  278","line":""},
{"lineNum":"  279","line":"    let every: String = every","class":"lineCov","hits":"1","order":"1040",},
{"lineNum":"  280","line":"        .to_rust::<Option<String>>(cr)","class":"lineCov","hits":"1","order":"1041",},
{"lineNum":"  281","line":"        .unwrap_or(\"1d\".to_string());","class":"lineCov","hits":"1","order":"1039",},
{"lineNum":"  282","line":""},
{"lineNum":"  283","line":"    let cast_to_date: bool = cast_to_date.to_rust(cr);","class":"lineCov","hits":"1","order":"1038",},
{"lineNum":"  284","line":""},
{"lineNum":"  285","line":"    let series = date_range(","class":"lineCov","hits":"1","order":"1032",},
{"lineNum":"  286","line":"        &name,","class":"lineCov","hits":"1","order":"1037",},
{"lineNum":"  287","line":"        start,"},
{"lineNum":"  288","line":"        stop,"},
{"lineNum":"  289","line":"        Duration::parse(&every),","class":"lineCov","hits":"1","order":"1036",},
{"lineNum":"  290","line":"        ClosedWindow::Both,","class":"lineCov","hits":"1","order":"1035",},
{"lineNum":"  291","line":"        TimeUnit::Milliseconds,","class":"lineCov","hits":"1","order":"1034",},
{"lineNum":"  292","line":"        None,","class":"lineCov","hits":"1","order":"1033",},
{"lineNum":"  293","line":"    )"},
{"lineNum":"  294","line":"    .and_then(|date_range| {","class":"lineCov","hits":"1","order":"1031",},
{"lineNum":"  295","line":"        let series = date_range.into_series();","class":"lineCov","hits":"1","order":"1029",},
{"lineNum":"  296","line":"        if cast_to_date {","class":"lineCov","hits":"1","order":"1028",},
{"lineNum":"  297","line":"            series.cast(&DataType::Date)","class":"lineCov","hits":"1","order":"1026",},
{"lineNum":"  298","line":"        } else {"},
{"lineNum":"  299","line":"            Ok(series)","class":"lineCov","hits":"1","order":"1027",},
{"lineNum":"  300","line":"        }"},
{"lineNum":"  301","line":"    })","class":"lineCov","hits":"1","order":"1025",},
{"lineNum":"  302","line":"    .map(Abstract)"},
{"lineNum":"  303","line":"    .map_err(|err| err.to_string());","class":"lineNoCov","hits":"0",},
{"lineNum":"  304","line":""},
{"lineNum":"  305","line":"    series.to_ocaml(cr)","class":"lineCov","hits":"1","order":"1030",},
{"lineNum":"  306","line":"}","class":"lineCov","hits":"1","order":"1043",},
{"lineNum":"  307","line":""},
{"lineNum":"  308","line":"fn series_to_boxrooted_ocaml_list(","class":"lineCov","hits":"1","order":"229",},
{"lineNum":"  309","line":"    cr: &mut &mut OCamlRuntime,"},
{"lineNum":"  310","line":"    data_type: &GADTDataType,"},
{"lineNum":"  311","line":"    series: Series,"},
{"lineNum":"  312","line":"    allow_nulls: bool,"},
{"lineNum":"  313","line":") -> Result<DummyBoxRoot, String> {"},
{"lineNum":"  314","line":"    if !allow_nulls && series.null_count() > 0 {","class":"lineCov","hits":"1","order":"230",},
{"lineNum":"  315","line":"        return Err(format!(","class":"lineCov","hits":"1","order":"517",},
{"lineNum":"  316","line":"            \"Series contains {} null values, expected none\","},
{"lineNum":"  317","line":"            series.null_count()","class":"lineCov","hits":"1","order":"516",},
{"lineNum":"  318","line":"        )"},
{"lineNum":"  319","line":"        .to_string());","class":"lineCov","hits":"1","order":"518",},
{"lineNum":"  320","line":"    }"},
{"lineNum":"  321","line":""},
{"lineNum":"  322","line":"    macro_rules! create_boxrooted_ocaml_list {"},
{"lineNum":"  323","line":"        ($rust_type:ty, $ocaml_type:ty, $body:expr) => {{"},
{"lineNum":"  324","line":"            let vec: Vec<$rust_type> = $body;"},
{"lineNum":"  325","line":""},
{"lineNum":"  326","line":"            let return_value: BoxRoot<OCamlList<$ocaml_type>> = vec.to_ocaml(cr).root();"},
{"lineNum":"  327","line":""},
{"lineNum":"  328","line":"            Ok(unsafe { DummyBoxRoot::new(return_value) })"},
{"lineNum":"  329","line":"        }};"},
{"lineNum":"  330","line":"    }"},
{"lineNum":"  331","line":""},
{"lineNum":"  332","line":"    macro_rules! create_boxrooted_ocaml_list_handle_nulls {"},
{"lineNum":"  333","line":"        ($rust_type:ty, $ocaml_type:ty, $body_allow_nulls:expr, $body_disallow_nulls:expr) => {{"},
{"lineNum":"  334","line":"            if allow_nulls {"},
{"lineNum":"  335","line":"                create_boxrooted_ocaml_list!("},
{"lineNum":"  336","line":"                    Option<$rust_type>,"},
{"lineNum":"  337","line":"                    Option<$ocaml_type>,"},
{"lineNum":"  338","line":"                    $body_allow_nulls"},
{"lineNum":"  339","line":"                )"},
{"lineNum":"  340","line":"            } else {"},
{"lineNum":"  341","line":"                create_boxrooted_ocaml_list!($rust_type, $ocaml_type, $body_disallow_nulls)"},
{"lineNum":"  342","line":"            }"},
{"lineNum":"  343","line":"        }};"},
{"lineNum":"  344","line":"    }"},
{"lineNum":"  345","line":""},
{"lineNum":"  346","line":"    macro_rules! ocaml_intable {"},
{"lineNum":"  347","line":"        ($rust_type:ty, $ca:expr) => {{"},
{"lineNum":"  348","line":"            let ca = $ca.map_err(|err| err.to_string())?;","class":"lineNoCov","hits":"0",},
{"lineNum":"  349","line":""},
{"lineNum":"  350","line":"            create_boxrooted_ocaml_list_handle_nulls!("},
{"lineNum":"  351","line":"                OCamlIntable<$rust_type>,"},
{"lineNum":"  352","line":"                OCamlInt,"},
{"lineNum":"  353","line":"                ca.into_iter().map(|n| n.map(OCamlIntable)).collect(),","class":"lineCov","hits":"1","order":"513",},
{"lineNum":"  354","line":"                {"},
{"lineNum":"  355","line":"                    let mut buf = Vec::with_capacity(ca.len());"},
{"lineNum":"  356","line":"                    for arr in ca.downcast_iter() {"},
{"lineNum":"  357","line":"                        buf.extend(arr.values_iter().map(|n| OCamlIntable(*n)))","class":"lineCov","hits":"1","order":"233",},
{"lineNum":"  358","line":"                    }"},
{"lineNum":"  359","line":"                    buf"},
{"lineNum":"  360","line":"                }"},
{"lineNum":"  361","line":"            )"},
{"lineNum":"  362","line":"        }};"},
{"lineNum":"  363","line":"    }"},
{"lineNum":"  364","line":""},
{"lineNum":"  365","line":"    match data_type {","class":"lineCov","hits":"1","order":"231",},
{"lineNum":"  366","line":"        GADTDataType::Boolean => {"},
{"lineNum":"  367","line":"            let ca = series.bool().map_err(|err| err.to_string())?;","class":"lineCov","hits":"1","order":"270",},
{"lineNum":"  368","line":""},
{"lineNum":"  369","line":"            create_boxrooted_ocaml_list_handle_nulls!(bool, bool, ca.into_iter().collect(), {","class":"lineCov","hits":"1","order":"271",},
{"lineNum":"  370","line":"                let mut buf = Vec::with_capacity(ca.len());","class":"lineCov","hits":"1","order":"272",},
{"lineNum":"  371","line":"                for arr in ca.downcast_iter() {","class":"lineCov","hits":"1","order":"273",},
{"lineNum":"  372","line":"                    buf.extend(arr.values_iter())","class":"lineCov","hits":"1","order":"274",},
{"lineNum":"  373","line":"                }"},
{"lineNum":"  374","line":"                buf","class":"lineCov","hits":"1","order":"275",},
{"lineNum":"  375","line":"            })","class":"lineNoCov","hits":"0",},
{"lineNum":"  376","line":"        }"},
{"lineNum":"  377","line":"        GADTDataType::UInt8 => ocaml_intable!(u8, series.u8()),","class":"lineCov","hits":"1","order":"577",},
{"lineNum":"  378","line":"        GADTDataType::UInt16 => ocaml_intable!(u16, series.u16()),","class":"lineCov","hits":"1","order":"606",},
{"lineNum":"  379","line":"        GADTDataType::UInt32 => ocaml_intable!(u32, series.u32()),","class":"lineCov","hits":"1","order":"615",},
{"lineNum":"  380","line":"        GADTDataType::UInt64 => ocaml_intable!(u64, series.u64()),","class":"lineCov","hits":"1","order":"609",},
{"lineNum":"  381","line":"        GADTDataType::Int8 => ocaml_intable!(i8, series.i8()),","class":"lineCov","hits":"1","order":"545",},
{"lineNum":"  382","line":"        GADTDataType::Int16 => ocaml_intable!(i16, series.i16()),","class":"lineCov","hits":"1","order":"602",},
{"lineNum":"  383","line":"        GADTDataType::Int32 => ocaml_intable!(i32, series.i32()),","class":"lineCov","hits":"1","order":"600",},
{"lineNum":"  384","line":"        GADTDataType::Int64 => ocaml_intable!(i64, series.i64()),","class":"lineCov","hits":"1","order":"232",},
{"lineNum":"  385","line":"        GADTDataType::Float32 => {"},
{"lineNum":"  386","line":"            let ca = series.f32().map_err(|err| err.to_string())?;","class":"lineCov","hits":"1","order":"586",},
{"lineNum":"  387","line":""},
{"lineNum":"  388","line":"            create_boxrooted_ocaml_list_handle_nulls!(","class":"lineCov","hits":"1","order":"587",},
{"lineNum":"  389","line":"                f64,"},
{"lineNum":"  390","line":"                OCamlFloat,"},
{"lineNum":"  391","line":"                ca.into_iter()","class":"lineCov","hits":"1","order":"592",},
{"lineNum":"  392","line":"                    .map(|f32o| f32o.map(|f32| f32 as f64))","class":"lineCov","hits":"1","order":"593",},
{"lineNum":"  393","line":"                    .collect(),"},
{"lineNum":"  394","line":"                {"},
{"lineNum":"  395","line":"                    let mut buf = Vec::with_capacity(ca.len());","class":"lineCov","hits":"1","order":"588",},
{"lineNum":"  396","line":"                    for arr in ca.downcast_iter() {","class":"lineCov","hits":"1","order":"589",},
{"lineNum":"  397","line":"                        buf.extend(arr.values_iter().map(|f32| *f32 as f64))","class":"lineCov","hits":"1","order":"590",},
{"lineNum":"  398","line":"                    }"},
{"lineNum":"  399","line":"                    buf","class":"lineCov","hits":"1","order":"591",},
{"lineNum":"  400","line":"                }","class":"lineNoCov","hits":"0",},
{"lineNum":"  401","line":"            )"},
{"lineNum":"  402","line":"        }"},
{"lineNum":"  403","line":"        GADTDataType::Float64 => {"},
{"lineNum":"  404","line":"            let ca = series.f64().map_err(|err| err.to_string())?;","class":"lineCov","hits":"1","order":"245",},
{"lineNum":"  405","line":""},
{"lineNum":"  406","line":"            create_boxrooted_ocaml_list_handle_nulls!(f64, OCamlFloat, ca.into_iter().collect(), {","class":"lineCov","hits":"1","order":"246",},
{"lineNum":"  407","line":"                let mut buf = Vec::with_capacity(ca.len());","class":"lineCov","hits":"1","order":"247",},
{"lineNum":"  408","line":"                for arr in ca.downcast_iter() {","class":"lineCov","hits":"1","order":"248",},
{"lineNum":"  409","line":"                    buf.extend(arr.values_iter())","class":"lineCov","hits":"1","order":"249",},
{"lineNum":"  410","line":"                }"},
{"lineNum":"  411","line":"                buf","class":"lineCov","hits":"1","order":"250",},
{"lineNum":"  412","line":"            })","class":"lineNoCov","hits":"0",},
{"lineNum":"  413","line":"        }"},
{"lineNum":"  414","line":"        GADTDataType::Utf8 => {"},
{"lineNum":"  415","line":"            let ca = series.utf8().map_err(|err| err.to_string())?;","class":"lineCov","hits":"1","order":"251",},
{"lineNum":"  416","line":"            create_boxrooted_ocaml_list_handle_nulls!(&str, String, ca.into_iter().collect(), {","class":"lineCov","hits":"1","order":"252",},
{"lineNum":"  417","line":"                let mut buf = Vec::with_capacity(ca.len());","class":"lineCov","hits":"1","order":"253",},
{"lineNum":"  418","line":"                for arr in ca.downcast_iter() {","class":"lineCov","hits":"1","order":"254",},
{"lineNum":"  419","line":"                    buf.extend(arr.values_iter())","class":"lineCov","hits":"1","order":"255",},
{"lineNum":"  420","line":"                }"},
{"lineNum":"  421","line":"                buf","class":"lineCov","hits":"1","order":"256",},
{"lineNum":"  422","line":"            })","class":"lineNoCov","hits":"0",},
{"lineNum":"  423","line":"        }"},
{"lineNum":"  424","line":"        GADTDataType::Binary => {"},
{"lineNum":"  425","line":"            let ca = series.binary().map_err(|err| err.to_string())?;","class":"lineCov","hits":"1","order":"520",},
{"lineNum":"  426","line":""},
{"lineNum":"  427","line":"            create_boxrooted_ocaml_list_handle_nulls!(&[u8], String, ca.into_iter().collect(), {","class":"lineCov","hits":"1","order":"521",},
{"lineNum":"  428","line":"                let mut buf = Vec::with_capacity(ca.len());","class":"lineCov","hits":"1","order":"522",},
{"lineNum":"  429","line":"                for arr in ca.downcast_iter() {","class":"lineCov","hits":"1","order":"523",},
{"lineNum":"  430","line":"                    buf.extend(arr.values_iter())","class":"lineCov","hits":"1","order":"524",},
{"lineNum":"  431","line":"                }"},
{"lineNum":"  432","line":"                buf","class":"lineCov","hits":"1","order":"525",},
{"lineNum":"  433","line":"            })","class":"lineNoCov","hits":"0",},
{"lineNum":"  434","line":"        }"},
{"lineNum":"  435","line":"        GADTDataType::List(data_type) => {","class":"lineCov","hits":"1","order":"257",},
{"lineNum":"  436","line":"            let ca = series.list().map_err(|err| err.to_string())?;","class":"lineCov","hits":"1","order":"258",},
{"lineNum":"  437","line":""},
{"lineNum":"  438","line":"            create_boxrooted_ocaml_list_handle_nulls!(","class":"lineCov","hits":"1","order":"259",},
{"lineNum":"  439","line":"                DummyBoxRoot,"},
{"lineNum":"  440","line":"                DummyBoxRoot,"},
{"lineNum":"  441","line":"                ca.into_iter()","class":"lineCov","hits":"1","order":"546",},
{"lineNum":"  442","line":"                    .map(|serieso| match serieso {","class":"lineCov","hits":"1","order":"547",},
{"lineNum":"  443","line":"                        None => Ok(None),","class":"lineCov","hits":"1","order":"657",},
{"lineNum":"  444","line":"                        Some(series) => {","class":"lineCov","hits":"1","order":"548",},
{"lineNum":"  445","line":"                            // See comment on similar recursive call in series_new on why allow_nulls=false"},
{"lineNum":"  446","line":"                            series_to_boxrooted_ocaml_list(cr, data_type, series, false).map(Some)","class":"lineCov","hits":"1","order":"549",},
{"lineNum":"  447","line":"                        }"},
{"lineNum":"  448","line":"                    })","class":"lineCov","hits":"1","order":"550",},
{"lineNum":"  449","line":"                    .collect::<Result<_, _>>()?,","class":"lineNoCov","hits":"0",},
{"lineNum":"  450","line":"                {"},
{"lineNum":"  451","line":"                    let mut buf = Vec::with_capacity(ca.len());","class":"lineCov","hits":"1","order":"260",},
{"lineNum":"  452","line":""},
{"lineNum":"  453","line":"                    // Based off of"},
{"lineNum":"  454","line":"                    // https://github.com/pola-rs/polars/blob/b91cd2d3fa42f80319d23d057fd9691ba474bd61/crates/polars-core/src/chunked_array/iterator/mod.rs#L304"},
{"lineNum":"  455","line":"                    // TBH I don\'t fully understand how this works, but hey, it\'s quickcheck tested!"},
{"lineNum":"  456","line":"                    for arr in ca","class":"lineCov","hits":"1","order":"261",},
{"lineNum":"  457","line":"                        .downcast_iter()"},
{"lineNum":"  458","line":"                        .flat_map(|arr| arr.iter().unwrap_required())","class":"lineCov","hits":"1","order":"262",},
{"lineNum":"  459","line":"                    {"},
{"lineNum":"  460","line":"                        let series = unsafe {"},
{"lineNum":"  461","line":"                            Series::from_chunks_and_dtype_unchecked(","class":"lineCov","hits":"1","order":"265",},
{"lineNum":"  462","line":"                                \"\","},
{"lineNum":"  463","line":"                                vec![arr],","class":"lineCov","hits":"1","order":"263",},
{"lineNum":"  464","line":"                                &ca.inner_dtype(),","class":"lineCov","hits":"1","order":"264",},
{"lineNum":"  465","line":"                            )","class":"lineCov","hits":"1","order":"266",},
{"lineNum":"  466","line":"                        };","class":"lineCov","hits":"1","order":"267",},
{"lineNum":"  467","line":"                        // See comment on similar recursive call in series_new on why allow_nulls=false"},
{"lineNum":"  468","line":"                        buf.push(series_to_boxrooted_ocaml_list(","class":"lineCov","hits":"1","order":"269",},
{"lineNum":"  469","line":"                            cr, data_type, series, false,","class":"lineCov","hits":"1","order":"268",},
{"lineNum":"  470","line":"                        )?)","class":"lineNoCov","hits":"0",},
{"lineNum":"  471","line":"                    }","class":"lineCov","hits":"1","order":"276",},
{"lineNum":"  472","line":""},
{"lineNum":"  473","line":"                    buf","class":"lineCov","hits":"1","order":"277",},
{"lineNum":"  474","line":"                }","class":"lineNoCov","hits":"0",},
{"lineNum":"  475","line":"            )"},
{"lineNum":"  476","line":"        }"},
{"lineNum":"  477","line":"    }"},
{"lineNum":"  478","line":"}","class":"lineCov","hits":"1","order":"240",},
{"lineNum":"  479","line":""},
{"lineNum":"  480","line":"#[ocaml_interop_export(raise_on_err)]","class":"lineCov","hits":"1","order":"222",},
{"lineNum":"  481","line":"fn rust_series_to_list("},
{"lineNum":"  482","line":"    cr: &mut &mut OCamlRuntime,","class":"lineCov","hits":"1","order":"223",},
{"lineNum":"  483","line":"    data_type: OCamlRef<GADTDataType>,","class":"lineCov","hits":"1","order":"224",},
{"lineNum":"  484","line":"    series: OCamlRef<DynBox<Series>>,","class":"lineCov","hits":"1","order":"225",},
{"lineNum":"  485","line":") -> OCaml<DummyBoxRoot> {"},
{"lineNum":"  486","line":"    let data_type: GADTDataType = data_type.to_rust(cr);","class":"lineCov","hits":"1","order":"226",},
{"lineNum":"  487","line":"    let Abstract(series) = series.to_rust(cr);","class":"lineCov","hits":"1","order":"227",},
{"lineNum":"  488","line":""},
{"lineNum":"  489","line":"    series_to_boxrooted_ocaml_list(cr, &data_type, series, false)?.to_ocaml(cr)","class":"lineCov","hits":"1","order":"228",},
{"lineNum":"  490","line":"}","class":"lineCov","hits":"1","order":"244",},
{"lineNum":"  491","line":""},
{"lineNum":"  492","line":"#[ocaml_interop_export(raise_on_err)]","class":"lineCov","hits":"1","order":"506",},
{"lineNum":"  493","line":"fn rust_series_to_option_list("},
{"lineNum":"  494","line":"    cr: &mut &mut OCamlRuntime,","class":"lineCov","hits":"1","order":"507",},
{"lineNum":"  495","line":"    data_type: OCamlRef<GADTDataType>,","class":"lineCov","hits":"1","order":"508",},
{"lineNum":"  496","line":"    series: OCamlRef<DynBox<Series>>,","class":"lineCov","hits":"1","order":"509",},
{"lineNum":"  497","line":") -> OCaml<DummyBoxRoot> {"},
{"lineNum":"  498","line":"    let data_type: GADTDataType = data_type.to_rust(cr);","class":"lineCov","hits":"1","order":"510",},
{"lineNum":"  499","line":"    let Abstract(series) = series.to_rust(cr);","class":"lineCov","hits":"1","order":"511",},
{"lineNum":"  500","line":""},
{"lineNum":"  501","line":"    series_to_boxrooted_ocaml_list(cr, &data_type, series, true)?.to_ocaml(cr)","class":"lineCov","hits":"1","order":"512",},
{"lineNum":"  502","line":"}","class":"lineCov","hits":"1","order":"515",},
{"lineNum":"  503","line":""},
{"lineNum":"  504","line":"fn series_get(","class":"lineCov","hits":"1","order":"560",},
{"lineNum":"  505","line":"    cr: &mut &mut OCamlRuntime,"},
{"lineNum":"  506","line":"    data_type: &GADTDataType,"},
{"lineNum":"  507","line":"    series: Series,"},
{"lineNum":"  508","line":"    index: usize,"},
{"lineNum":"  509","line":") -> Result<DummyBoxRoot, String> {"},
{"lineNum":"  510","line":"    macro_rules! extract_value {"},
{"lineNum":"  511","line":"        ($rust_type:ty, $ocaml_type:ty, $body:expr) => {{"},
{"lineNum":"  512","line":"            let value: Option<$rust_type> = $body;"},
{"lineNum":"  513","line":""},
{"lineNum":"  514","line":"            let return_value: BoxRoot<Option<$ocaml_type>> = value.to_ocaml(cr).root();"},
{"lineNum":"  515","line":""},
{"lineNum":"  516","line":"            Ok(unsafe { DummyBoxRoot::new(return_value) })"},
{"lineNum":"  517","line":"        }};"},
{"lineNum":"  518","line":"    }"},
{"lineNum":"  519","line":""},
{"lineNum":"  520","line":"    macro_rules! extract_int_value {"},
{"lineNum":"  521","line":"        ($rust_type:ty, $body:expr) => {{"},
{"lineNum":"  522","line":"            extract_value!("},
{"lineNum":"  523","line":"                OCamlIntable<$rust_type>,"},
{"lineNum":"  524","line":"                OCamlInt,"},
{"lineNum":"  525","line":"                $body"},
{"lineNum":"  526","line":"                    .map_err(|err| err.to_string())?","class":"lineNoCov","hits":"0",},
{"lineNum":"  527","line":"                    .get(index)"},
{"lineNum":"  528","line":"                    .map(OCamlIntable)"},
{"lineNum":"  529","line":"            )"},
{"lineNum":"  530","line":"        }};"},
{"lineNum":"  531","line":"    }"},
{"lineNum":"  532","line":""},
{"lineNum":"  533","line":"    match data_type {","class":"lineCov","hits":"1","order":"561",},
{"lineNum":"  534","line":"        GADTDataType::Boolean => extract_value!(","class":"lineCov","hits":"1","order":"581",},
{"lineNum":"  535","line":"            bool,"},
{"lineNum":"  536","line":"            bool,"},
{"lineNum":"  537","line":"            series.bool().map_err(|err| err.to_string())?.get(index)","class":"lineCov","hits":"1","order":"580",},
{"lineNum":"  538","line":"        ),"},
{"lineNum":"  539","line":"        GADTDataType::Int8 => extract_int_value!(i8, series.i8()),","class":"lineCov","hits":"1","order":"613",},
{"lineNum":"  540","line":"        GADTDataType::Int16 => extract_int_value!(i16, series.i16()),","class":"lineCov","hits":"1","order":"603",},
{"lineNum":"  541","line":"        GADTDataType::Int32 => extract_int_value!(i32, series.i32()),","class":"lineCov","hits":"1","order":"625",},
{"lineNum":"  542","line":"        GADTDataType::Int64 => extract_int_value!(i64, series.i64()),","class":"lineCov","hits":"1","order":"579",},
{"lineNum":"  543","line":"        GADTDataType::UInt8 => extract_int_value!(u8, series.u8()),","class":"lineCov","hits":"1","order":"578",},
{"lineNum":"  544","line":"        GADTDataType::UInt16 => extract_int_value!(u16, series.u16()),","class":"lineCov","hits":"1","order":"607",},
{"lineNum":"  545","line":"        GADTDataType::UInt32 => extract_int_value!(u32, series.u32()),","class":"lineCov","hits":"1","order":"630",},
{"lineNum":"  546","line":"        GADTDataType::UInt64 => extract_int_value!(u64, series.u64()),","class":"lineCov","hits":"1","order":"610",},
{"lineNum":"  547","line":"        GADTDataType::Float32 => extract_value!(","class":"lineCov","hits":"1","order":"596",},
{"lineNum":"  548","line":"            f64,"},
{"lineNum":"  549","line":"            OCamlFloat,"},
{"lineNum":"  550","line":"            series","class":"lineCov","hits":"1","order":"594",},
{"lineNum":"  551","line":"                .f32()"},
{"lineNum":"  552","line":"                .map_err(|err| err.to_string())?","class":"lineNoCov","hits":"0",},
{"lineNum":"  553","line":"                .get(index)"},
{"lineNum":"  554","line":"                .map(|f32| f32 as f64)","class":"lineCov","hits":"1","order":"595",},
{"lineNum":"  555","line":"        ),"},
{"lineNum":"  556","line":"        GADTDataType::Float64 => extract_value!(","class":"lineCov","hits":"1","order":"612",},
{"lineNum":"  557","line":"            f64,"},
{"lineNum":"  558","line":"            OCamlFloat,"},
{"lineNum":"  559","line":"            series.f64().map_err(|err| err.to_string())?.get(index)","class":"lineCov","hits":"1","order":"611",},
{"lineNum":"  560","line":"        ),"},
{"lineNum":"  561","line":"        GADTDataType::Utf8 => extract_value!(","class":"lineCov","hits":"1","order":"598",},
{"lineNum":"  562","line":"            &str,"},
{"lineNum":"  563","line":"            String,"},
{"lineNum":"  564","line":"            series.utf8().map_err(|err| err.to_string())?.get(index)","class":"lineCov","hits":"1","order":"597",},
{"lineNum":"  565","line":"        ),"},
{"lineNum":"  566","line":"        GADTDataType::Binary => extract_value!(","class":"lineCov","hits":"1","order":"617",},
{"lineNum":"  567","line":"            &[u8],"},
{"lineNum":"  568","line":"            String,"},
{"lineNum":"  569","line":"            series.binary().map_err(|err| err.to_string())?.get(index)","class":"lineCov","hits":"1","order":"616",},
{"lineNum":"  570","line":"        ),"},
{"lineNum":"  571","line":"        GADTDataType::List(data_type) => extract_value!(","class":"lineCov","hits":"1","order":"562",},
{"lineNum":"  572","line":"            DummyBoxRoot,"},
{"lineNum":"  573","line":"            DummyBoxRoot,"},
{"lineNum":"  574","line":"            match series.list().map_err(|err| err.to_string())?.get(index) {","class":"lineCov","hits":"1","order":"563",},
{"lineNum":"  575","line":"                None => Ok(None),","class":"lineCov","hits":"1","order":"658",},
{"lineNum":"  576","line":"                Some(series) => {","class":"lineCov","hits":"1","order":"564",},
{"lineNum":"  577","line":"                    series_to_boxrooted_ocaml_list(cr, data_type, series, false).map(Some)","class":"lineCov","hits":"1","order":"565",},
{"lineNum":"  578","line":"                }"},
{"lineNum":"  579","line":"            }?","class":"lineNoCov","hits":"0",},
{"lineNum":"  580","line":"        ),"},
{"lineNum":"  581","line":"    }"},
{"lineNum":"  582","line":"}","class":"lineCov","hits":"1","order":"566",},
{"lineNum":"  583","line":""},
{"lineNum":"  584","line":"#[ocaml_interop_export(raise_on_err)]","class":"lineCov","hits":"1","order":"551",},
{"lineNum":"  585","line":"fn rust_series_get("},
{"lineNum":"  586","line":"    cr: &mut &mut OCamlRuntime,","class":"lineCov","hits":"1","order":"552",},
{"lineNum":"  587","line":"    data_type: OCamlRef<GADTDataType>,","class":"lineCov","hits":"1","order":"553",},
{"lineNum":"  588","line":"    series: OCamlRef<DynBox<Series>>,","class":"lineCov","hits":"1","order":"554",},
{"lineNum":"  589","line":"    index: OCamlRef<OCamlInt>,","class":"lineCov","hits":"1","order":"555",},
{"lineNum":"  590","line":") -> OCaml<DummyBoxRoot> {"},
{"lineNum":"  591","line":"    let data_type: GADTDataType = data_type.to_rust(cr);","class":"lineCov","hits":"1","order":"556",},
{"lineNum":"  592","line":"    let Abstract(series) = series.to_rust(cr);","class":"lineCov","hits":"1","order":"557",},
{"lineNum":"  593","line":"    let index = index.to_rust::<Coerce<_, i64, usize>>(cr).get()?;","class":"lineCov","hits":"1","order":"558",},
{"lineNum":"  594","line":""},
{"lineNum":"  595","line":"    series_get(cr, &data_type, series, index)?.to_ocaml(cr)","class":"lineCov","hits":"1","order":"559",},
{"lineNum":"  596","line":"}","class":"lineCov","hits":"1","order":"567",},
{"lineNum":"  597","line":""},
{"lineNum":"  598","line":"#[ocaml_interop_export]","class":"lineCov","hits":"1","order":"1061",},
{"lineNum":"  599","line":"fn rust_series_name(cr: &mut &mut OCamlRuntime, series: OCamlRef<DynBox<Series>>) -> OCaml<String> {","class":"lineCov","hits":"1","order":"1024",},
{"lineNum":"  600","line":"    let Abstract(series) = series.to_rust(cr);","class":"lineCov","hits":"1","order":"1023",},
{"lineNum":"  601","line":"    series.name().to_ocaml(cr)","class":"lineCov","hits":"1","order":"1022",},
{"lineNum":"  602","line":"}","class":"lineCov","hits":"1","order":"1058",},
{"lineNum":"  603","line":""},
{"lineNum":"  604","line":"#[ocaml_interop_export]","class":"lineCov","hits":"1","order":"1062",},
{"lineNum":"  605","line":"fn rust_series_rename("},
{"lineNum":"  606","line":"    cr: &mut &mut OCamlRuntime,","class":"lineCov","hits":"1","order":"1021",},
{"lineNum":"  607","line":"    series: OCamlRef<DynBox<Series>>,","class":"lineCov","hits":"1","order":"1020",},
{"lineNum":"  608","line":"    name: OCamlRef<String>,","class":"lineCov","hits":"1","order":"1019",},
{"lineNum":"  609","line":") -> OCaml<DynBox<Series>> {"},
{"lineNum":"  610","line":"    let Abstract(mut series) = series.to_rust(cr);","class":"lineCov","hits":"1","order":"1054",},
{"lineNum":"  611","line":"    let name: String = name.to_rust(cr);","class":"lineCov","hits":"1","order":"1052",},
{"lineNum":"  612","line":""},
{"lineNum":"  613","line":"    let _ = series.rename(&name);","class":"lineCov","hits":"1","order":"1053",},
{"lineNum":"  614","line":""},
{"lineNum":"  615","line":"    OCaml::box_value(cr, series)","class":"lineCov","hits":"1","order":"1055",},
{"lineNum":"  616","line":"}","class":"lineCov","hits":"1","order":"1056",},
{"lineNum":"  617","line":""},
{"lineNum":"  618","line":"#[ocaml_interop_export]","class":"lineNoCov","hits":"0",},
{"lineNum":"  619","line":"fn rust_series_dtype("},
{"lineNum":"  620","line":"    cr: &mut &mut OCamlRuntime,"},
{"lineNum":"  621","line":"    series: OCamlRef<DynBox<Series>>,","class":"lineNoCov","hits":"0",},
{"lineNum":"  622","line":") -> OCaml<DataType> {"},
{"lineNum":"  623","line":"    let Abstract(series) = series.to_rust(cr);","class":"lineNoCov","hits":"0",},
{"lineNum":"  624","line":"    PolarsDataType(series.dtype().clone()).to_ocaml(cr)","class":"lineNoCov","hits":"0",},
{"lineNum":"  625","line":"}","class":"lineNoCov","hits":"0",},
{"lineNum":"  626","line":""},
{"lineNum":"  627","line":"#[ocaml_interop_export]","class":"lineCov","hits":"1","order":"1063",},
{"lineNum":"  628","line":"fn rust_series_to_data_frame("},
{"lineNum":"  629","line":"    cr: &mut &mut OCamlRuntime,","class":"lineCov","hits":"1","order":"1018",},
{"lineNum":"  630","line":"    series: OCamlRef<DynBox<Series>>,","class":"lineCov","hits":"1","order":"1050",},
{"lineNum":"  631","line":") -> OCaml<DynBox<DataFrame>> {"},
{"lineNum":"  632","line":"    dyn_box!(cr, |series| series.into_frame())","class":"lineCov","hits":"1","order":"1051",},
{"lineNum":"  633","line":"}"},
{"lineNum":"  634","line":""},
{"lineNum":"  635","line":"#[ocaml_interop_export]","class":"lineNoCov","hits":"0",},
{"lineNum":"  636","line":"fn rust_series_sort("},
{"lineNum":"  637","line":"    cr: &mut &mut OCamlRuntime,"},
{"lineNum":"  638","line":"    series: OCamlRef<DynBox<Series>>,","class":"lineNoCov","hits":"0",},
{"lineNum":"  639","line":"    descending: OCamlRef<bool>,","class":"lineNoCov","hits":"0",},
{"lineNum":"  640","line":") -> OCaml<DynBox<Series>> {"},
{"lineNum":"  641","line":"    let descending: bool = descending.to_rust(cr);","class":"lineNoCov","hits":"0",},
{"lineNum":"  642","line":""},
{"lineNum":"  643","line":"    dyn_box!(cr, |series| series.sort(descending))","class":"lineNoCov","hits":"0",},
{"lineNum":"  644","line":"}"},
{"lineNum":"  645","line":""},
{"lineNum":"  646","line":"#[ocaml_interop_export(raise_on_err)]","class":"lineCov","hits":"1","order":"285",},
{"lineNum":"  647","line":"fn rust_series_head("},
{"lineNum":"  648","line":"    cr: &mut &mut OCamlRuntime,"},
{"lineNum":"  649","line":"    series: OCamlRef<DynBox<Series>>,","class":"lineCov","hits":"1","order":"286",},
{"lineNum":"  650","line":"    length: OCamlRef<Option<OCamlInt>>,","class":"lineCov","hits":"1","order":"287",},
{"lineNum":"  651","line":") -> OCaml<DynBox<Series>> {"},
{"lineNum":"  652","line":"    let length = length","class":"lineCov","hits":"1","order":"289",},
{"lineNum":"  653","line":"        .to_rust::<Coerce<_, Option<i64>, Option<usize>>>(cr)","class":"lineCov","hits":"1","order":"288",},
{"lineNum":"  654","line":"        .get()?;","class":"lineCov","hits":"1","order":"303",},
{"lineNum":"  655","line":""},
{"lineNum":"  656","line":"    dyn_box!(cr, |series| series.head(length))","class":"lineNoCov","hits":"0",},
{"lineNum":"  657","line":"}"},
{"lineNum":"  658","line":""},
{"lineNum":"  659","line":"#[ocaml_interop_export(raise_on_err)]","class":"lineNoCov","hits":"0",},
{"lineNum":"  660","line":"fn rust_series_tail("},
{"lineNum":"  661","line":"    cr: &mut &mut OCamlRuntime,"},
{"lineNum":"  662","line":"    series: OCamlRef<DynBox<Series>>,","class":"lineNoCov","hits":"0",},
{"lineNum":"  663","line":"    length: OCamlRef<Option<OCamlInt>>,","class":"lineNoCov","hits":"0",},
{"lineNum":"  664","line":") -> OCaml<DynBox<Series>> {"},
{"lineNum":"  665","line":"    let length = length","class":"lineNoCov","hits":"0",},
{"lineNum":"  666","line":"        .to_rust::<Coerce<_, Option<i64>, Option<usize>>>(cr)","class":"lineNoCov","hits":"0",},
{"lineNum":"  667","line":"        .get()?;","class":"lineNoCov","hits":"0",},
{"lineNum":"  668","line":""},
{"lineNum":"  669","line":"    dyn_box!(cr, |series| series.tail(length))","class":"lineNoCov","hits":"0",},
{"lineNum":"  670","line":"}"},
{"lineNum":"  671","line":""},
{"lineNum":"  672","line":"#[ocaml_interop_export(raise_on_err)]","class":"lineNoCov","hits":"0",},
{"lineNum":"  673","line":"fn rust_series_sample_n("},
{"lineNum":"  674","line":"    cr: &mut &mut OCamlRuntime,"},
{"lineNum":"  675","line":"    series: OCamlRef<DynBox<Series>>,","class":"lineNoCov","hits":"0",},
{"lineNum":"  676","line":"    n: OCamlRef<OCamlInt>,","class":"lineNoCov","hits":"0",},
{"lineNum":"  677","line":"    with_replacement: OCamlRef<bool>,","class":"lineNoCov","hits":"0",},
{"lineNum":"  678","line":"    shuffle: OCamlRef<bool>,","class":"lineNoCov","hits":"0",},
{"lineNum":"  679","line":"    seed: OCamlRef<Option<OCamlInt>>,","class":"lineNoCov","hits":"0",},
{"lineNum":"  680","line":") -> OCaml<Result<DynBox<Series>, String>> {"},
{"lineNum":"  681","line":"    let n = n.to_rust::<Coerce<_, i64, usize>>(cr).get()?;","class":"lineNoCov","hits":"0",},
{"lineNum":"  682","line":"    let with_replacement: bool = with_replacement.to_rust(cr);","class":"lineNoCov","hits":"0",},
{"lineNum":"  683","line":"    let shuffle: bool = shuffle.to_rust(cr);","class":"lineNoCov","hits":"0",},
{"lineNum":"  684","line":"    let seed = seed","class":"lineNoCov","hits":"0",},
{"lineNum":"  685","line":"        .to_rust::<Coerce<_, Option<i64>, Option<u64>>>(cr)","class":"lineNoCov","hits":"0",},
{"lineNum":"  686","line":"        .get()?;","class":"lineNoCov","hits":"0",},
{"lineNum":"  687","line":""},
{"lineNum":"  688","line":"    dyn_box_result!(cr, |series| {","class":"lineNoCov","hits":"0",},
{"lineNum":"  689","line":"        series.sample_n(n, with_replacement, shuffle, seed)","class":"lineNoCov","hits":"0",},
{"lineNum":"  690","line":"    })"},
{"lineNum":"  691","line":"}"},
{"lineNum":"  692","line":""},
{"lineNum":"  693","line":"#[ocaml_interop_export]","class":"lineNoCov","hits":"0",},
{"lineNum":"  694","line":"fn rust_series_fill_null_with_strategy("},
{"lineNum":"  695","line":"    cr: &mut &mut OCamlRuntime,"},
{"lineNum":"  696","line":"    series: OCamlRef<DynBox<Series>>,","class":"lineNoCov","hits":"0",},
{"lineNum":"  697","line":"    strategy: OCamlRef<FillNullStrategy>,","class":"lineNoCov","hits":"0",},
{"lineNum":"  698","line":") -> OCaml<Result<DynBox<Series>, String>> {"},
{"lineNum":"  699","line":"    let PolarsFillNullStrategy(strategy) = strategy.to_rust(cr);","class":"lineNoCov","hits":"0",},
{"lineNum":"  700","line":""},
{"lineNum":"  701","line":"    dyn_box_result!(cr, |series| series.fill_null(strategy))","class":"lineNoCov","hits":"0",},
{"lineNum":"  702","line":"}"},
{"lineNum":"  703","line":""},
{"lineNum":"  704","line":"#[ocaml_interop_export]","class":"lineNoCov","hits":"0",},
{"lineNum":"  705","line":"fn rust_series_interpolate("},
{"lineNum":"  706","line":"    cr: &mut &mut OCamlRuntime,"},
{"lineNum":"  707","line":"    series: OCamlRef<DynBox<Series>>,","class":"lineNoCov","hits":"0",},
{"lineNum":"  708","line":"    method: OCamlRef<InterpolationMethod>,","class":"lineNoCov","hits":"0",},
{"lineNum":"  709","line":") -> OCaml<DynBox<Series>> {"},
{"lineNum":"  710","line":"    let PolarsInterpolationMethod(method) = method.to_rust(cr);","class":"lineNoCov","hits":"0",},
{"lineNum":"  711","line":""},
{"lineNum":"  712","line":"    dyn_box!(cr, |series| interpolate(&series, method))","class":"lineNoCov","hits":"0",},
{"lineNum":"  713","line":"}"},
{"lineNum":"  714","line":""},
{"lineNum":"  715","line":"macro_rules! series_op {"},
{"lineNum":"  716","line":"    ($name:ident, |$($var:ident),+| $body:expr) => {"},
{"lineNum":"  717","line":"        dyn_box_op!($name, Series, |$($var),+| $body);"},
{"lineNum":"  718","line":"    }"},
{"lineNum":"  719","line":"}"},
{"lineNum":"  720","line":""},
{"lineNum":"  721","line":"macro_rules! series_op_result {"},
{"lineNum":"  722","line":"    ($name:ident, |$($var:ident),+| $body:expr) => {"},
{"lineNum":"  723","line":"        dyn_box_op_result!($name, Series, |$($var),+| $body);"},
{"lineNum":"  724","line":"    }"},
{"lineNum":"  725","line":"}"},
{"lineNum":"  726","line":""},
{"lineNum":"  727","line":"series_op_result!(rust_series_eq, |series, other| {","class":"lineNoCov","hits":"0",},
{"lineNum":"  728","line":"    series.equal(&other).map(|series| series.into_series())","class":"lineNoCov","hits":"0",},
{"lineNum":"  729","line":"});"},
{"lineNum":"  730","line":"series_op_result!(rust_series_neq, |series, other| {","class":"lineNoCov","hits":"0",},
{"lineNum":"  731","line":"    series.not_equal(&other).map(|series| series.into_series())","class":"lineNoCov","hits":"0",},
{"lineNum":"  732","line":"});"},
{"lineNum":"  733","line":"series_op_result!(rust_series_gt, |series, other| {","class":"lineNoCov","hits":"0",},
{"lineNum":"  734","line":"    series.gt(&other).map(|series| series.into_series())","class":"lineNoCov","hits":"0",},
{"lineNum":"  735","line":"});"},
{"lineNum":"  736","line":"series_op_result!(rust_series_gt_eq, |series, other| {","class":"lineNoCov","hits":"0",},
{"lineNum":"  737","line":"    series.gt_eq(&other).map(|series| series.into_series())","class":"lineNoCov","hits":"0",},
{"lineNum":"  738","line":"});"},
{"lineNum":"  739","line":"series_op_result!(rust_series_lt, |series, other| {","class":"lineNoCov","hits":"0",},
{"lineNum":"  740","line":"    series.lt(&other).map(|series| series.into_series())","class":"lineNoCov","hits":"0",},
{"lineNum":"  741","line":"});"},
{"lineNum":"  742","line":"series_op_result!(rust_series_lt_eq, |series, other| {","class":"lineNoCov","hits":"0",},
{"lineNum":"  743","line":"    series.lt_eq(&other).map(|series| series.into_series())","class":"lineNoCov","hits":"0",},
{"lineNum":"  744","line":"});"},
{"lineNum":"  745","line":""},
{"lineNum":"  746","line":"series_op!(rust_series_add, |series, other| series + other);","class":"lineNoCov","hits":"0",},
{"lineNum":"  747","line":"series_op!(rust_series_sub, |series, other| series - other);","class":"lineNoCov","hits":"0",},
{"lineNum":"  748","line":"series_op!(rust_series_mul, |series, other| series * other);","class":"lineNoCov","hits":"0",},
{"lineNum":"  749","line":"series_op!(rust_series_div, |series, other| series / other);","class":"lineNoCov","hits":"0",},
{"lineNum":"  750","line":""},
{"lineNum":"  751","line":"#[ocaml_interop_export]","class":"lineCov","hits":"1","order":"187",},
{"lineNum":"  752","line":"fn rust_series_to_string_hum("},
{"lineNum":"  753","line":"    cr: &mut &mut OCamlRuntime,"},
{"lineNum":"  754","line":"    series: OCamlRef<DynBox<Series>>,","class":"lineCov","hits":"1","order":"188",},
{"lineNum":"  755","line":") -> OCaml<String> {"},
{"lineNum":"  756","line":"    let Abstract(series) = series.to_rust(cr);","class":"lineCov","hits":"1","order":"189",},
{"lineNum":"  757","line":"    ToString::to_string(&series).to_ocaml(cr)","class":"lineCov","hits":"1","order":"190",},
{"lineNum":"  758","line":"}","class":"lineCov","hits":"1","order":"191",},
]};
var percent_low = 25;var percent_high = 75;
var header = { "command" : "inline_test_runner_polars_tests.exe", "date" : "2023-09-17 15:58:55", "instrumented" : 393, "covered" : 318,};
var merged_data = [];
